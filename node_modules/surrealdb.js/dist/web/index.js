!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Surreal",[],t):"object"==typeof exports?exports.Surreal=t():e.Surreal=t()}(self,(()=>(()=>{var e={31:e=>{"undefined"!=typeof WebSocket?e.exports=WebSocket:"undefined"!=typeof window?e.exports=window.WebSocket:"undefined"!=typeof FastBoot&&(e.exports=FastBoot.require("ws"))}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";n.d(r,{default:()=>Ue});let e=e=>crypto.getRandomValues(new Uint8Array(e));var t=((t,n=21)=>((e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,o=-~(1.6*r*t/e.length);return(i=t)=>{let u="";for(;;){let t=n(o),c=o;for(;c--;)if(u+=e[t[c]&r]||"",u.length===i)return u}}})("1234567890abcdefghijklmnopqrstuvwxyz",n,e))(0,10);function o(){return t()}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function l(e){var t=h();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){var t="function"==typeof Map?new Map:void 0;return p=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return y(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,e)},p(e)}function y(e,t,n){return y=h()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&v(o,n.prototype),o},y.apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}const w={AuthenticationError:function(e){f(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).name="AuthenticationError",r}return c(n)}(p(Error)),PermissionError:function(e){f(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).name="PermissionError",r}return c(n)}(p(Error)),RecordError:function(e){f(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).name="RecordError",r}return c(n)}(p(Error))};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){var n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t);return function(e,t){return t.get?t.get.call(e):t.value}(e,n)}var k=new WeakMap,E=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r={writable:!0,value:{}},function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,n=k),n.set(t,r)}var t,n;return t=e,n=[{key:"on",value:function(e,t){"object"!==b(g(this,k)[e])&&(g(this,k)[e]=[]),g(this,k)[e].push(t)}},{key:"off",value:function(e,t){if("object"===b(g(this,k)[e])){var n=g(this,k)[e].indexOf(t);n>-1&&g(this,k)[e].splice(n,1)}}},{key:"once",value:function(e,t){this.on(e,(function n(){this.off(e,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];t.apply(this,o)}))}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];"object"===b(g(this,k)[e])&&g(this,k)[e].forEach((function(e){e.apply(t,r)}))}},{key:"removeAllListeners",value:function(e){if(e)"object"===b(g(this,k)[e])&&(g(this,k)[e]=[]);else for(var t in g(this,k))g(this,k)[t]=[]}}],n&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function S(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function _(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function W(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,M(e,t,"get"))}function x(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,M(e,t,"set"),n),n}function M(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var A=new WeakMap,L=new WeakMap,C=new WeakMap,B=new WeakMap,q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(r);if(o){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function u(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),_(T(r=i.call(this)),A,{writable:!0,value:void 0}),_(T(r),L,{writable:!0,value:void 0}),_(T(r),C,{writable:!0,value:void 0}),_(T(r),B,{writable:!0,value:void 0}),x(T(r),L,e),x(T(r),C,t),x(T(r),B,n),W(T(r),L).ready&&r.open(),W(T(r),L).on("opened",(function(e){r.open()})),W(T(r),L).on("closed",(function(e){x(T(r),A,void 0)})),W(T(r),L).on("notify",(function(e){if(e.query===W(T(r),A))switch(e.action){case"CREATE":return r.emit("create",e.result);case"UPDATE":return r.emit("update",e.result);case"DELETE":return r.emit("delete",e.result)}})),r}return t=u,(n=[{key:"kill",value:function(){if(void 0!==W(this,A)){var e=W(this,L).kill(W(this,A));return x(this,A,void 0),e}}},{key:"open",value:function(){var e=this;if(void 0===W(this,A))return W(this,L).query(W(this,C),W(this,B)).then((function(t){t[0]&&t[0].result&&t[0].result[0]&&x(e,A,t[0].result[0])}))}}])&&P(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(E),z=n(31);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function I(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return N(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function V(e,t,n){G(e,t),t.set(e,n)}function G(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Q(e,t,"get"))}function K(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Q(e,t,"set"),n),n}function Q(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function X(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Y=Symbol("Opened"),Z=Symbol("Closed"),$=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakSet,oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J(r);if(o){var n=J(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return I(this,e)});function u(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),G(n=N(t=i.call(this)),r=re),r.add(n),V(N(t),$,{writable:!0,value:null}),V(N(t),ee,{writable:!0,value:null}),V(N(t),te,{writable:!0,value:!1}),V(N(t),ne,{writable:!0,value:Z}),X(N(t),re,ie).call(N(t)),K(N(t),ee,String(e).replace("http://","ws://").replace("https://","wss://")),t}return t=u,n=[{key:"open",value:function(){var e=this;K(this,$,new z(H(this,ee))),H(this,$).addEventListener("message",(function(t){e.emit("message",t)})),H(this,$).addEventListener("error",(function(t){e.emit("error",t)})),H(this,$).addEventListener("close",(function(t){e.emit("close",t)})),H(this,$).addEventListener("open",(function(t){e.emit("open",t)})),H(this,$).addEventListener("close",(function(t){H(e,ne)===Y&&X(e,re,ie).call(e)})),H(this,$).addEventListener("close",(function(t){K(e,ne,Z)})),H(this,$).addEventListener("open",(function(t){K(e,ne,Y)})),H(this,$).addEventListener("close",(function(t){!1===H(e,te)&&setTimeout((function(){e.open()}),2500)})),H(this,$).addEventListener("open",(function(t){e.resolve()}))}},{key:"send",value:function(e){H(this,$).send(e)}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Some reason";K(this,te,!0),H(this,$).close(e,t)}}],n&&F(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(E);function ie(){var e=this;this.ready=new Promise((function(t){e.resolve=t}))}function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function fe(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,se(e,t,"get"))}function le(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,se(e,t,"set"),n),n}function se(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var pe=new WeakMap,ye=new WeakMap,he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;ue(this,e),ae(this,pe,{writable:!0,value:void 0}),ae(this,ye,{writable:!0,value:void 0}),le(this,ye,t)}var t,n;return t=e,(n=[{key:"start",value:function(e){le(this,pe,setInterval(e,fe(this,ye)))}},{key:"stop",value:function(){clearInterval(fe(this,pe))}}])&&ce(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},we(e,t)}function be(e,t){if(t&&("object"===ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return me(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(e)}function ke(e,t){Oe(e,t),t.add(e)}function Ee(e,t,n){Oe(e,t),t.set(e,n)}function Oe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function je(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Te(e,t,"set"),n),n}function Se(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Te(e,t,"get"))}function Te(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Re=void 0,_e=new WeakMap,We=new WeakMap,xe=new WeakMap,Me=new WeakMap,Ae=new WeakMap,Le=new WeakSet,Ce=new WeakSet,Be=new WeakSet,qe=new WeakSet,ze=new WeakSet,De=new WeakSet,Fe=new WeakSet,Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}(a,e);var t,n,r,i,u,c=(i=a,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ge(i);if(u){var n=ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return be(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ke(me(n=c.call(this)),Fe),ke(me(n),De),ke(me(n),ze),ke(me(n),qe),ke(me(n),Be),ke(me(n),Ce),ke(me(n),Le),Ee(me(n),_e,{writable:!0,value:void 0}),Ee(me(n),We,{writable:!0,value:void 0}),Ee(me(n),xe,{writable:!0,value:void 0}),Ee(me(n),Me,{writable:!0,value:void 0}),Ee(me(n),Ae,{writable:!0,value:void 0}),je(me(n),We,e),je(me(n),xe,t),e&&n.connect(e),n}return t=a,r=[{key:"Instance",get:function(){return Re||(Re=new a)}},{key:"AuthenticationError",get:function(){return w.AuthenticationError}},{key:"PermissionError",get:function(){return w.PermissionError}},{key:"RecordError",get:function(){return w.RecordError}},{key:"Live",get:function(){return q}}],(n=[{key:"token",get:function(){return Se(this,xe)},set:function(e){je(this,xe,e)}},{key:"connect",value:function(e){var t=this;return je(this,_e,new oe(e)),je(this,Me,new he(3e4)),Se(this,_e).on("open",(function(){Pe(t,Le,Ie).call(t)})),Se(this,_e).on("open",(function(){t.emit("open"),t.emit("opened"),Se(t,Me).start((function(){t.ping()}))})),Se(this,_e).on("close",(function(){t.emit("close"),t.emit("closed"),Se(t,Me).stop()})),Se(this,_e).on("message",(function(e){var n=JSON.parse(e.data);return"notify"!==n.method?t.emit(n.id,n):"notify"===n.method?n.params.forEach((function(e){t.emit("notify",e)})):void 0})),Se(this,_e).open(),this.wait()}},{key:"sync",value:function(e,t){return new q(this,e,t)}},{key:"wait",value:function(){var e=this;return Se(this,_e).ready.then((function(){return Se(e,Ae)}))}},{key:"close",value:function(){Se(this,_e).removeAllListeners(),Se(this,_e).close()}},{key:"ping",value:function(){var e=this,t=o();return Se(this,_e).ready.then((function(){return new Promise((function(){Pe(e,Ce,Ne).call(e,t,"ping")}))}))}},{key:"use",value:function(e,t){var n=this,r=o();return Se(this,_e).ready.then((function(){return new Promise((function(o,i){n.once(r,(function(e){return Pe(n,De,He).call(n,e,o,i)})),Pe(n,Ce,Ne).call(n,r,"use",[e,t])}))}))}},{key:"info",value:function(){var e=this,t=o();return Se(this,_e).ready.then((function(){return new Promise((function(n,r){e.once(t,(function(t){return Pe(e,De,He).call(e,t,n,r)})),Pe(e,Ce,Ne).call(e,t,"info")}))}))}},{key:"signup",value:function(e){var t=this,n=o();return Se(this,_e).ready.then((function(){return new Promise((function(r,o){t.once(n,(function(e){return Pe(t,ze,Ge).call(t,e,r,o)})),Pe(t,Ce,Ne).call(t,n,"signup",[e])}))}))}},{key:"signin",value:function(e){var t=this,n=o();return Se(this,_e).ready.then((function(){return new Promise((function(r,o){t.once(n,(function(e){return Pe(t,qe,Ve).call(t,e,r,o)})),Pe(t,Ce,Ne).call(t,n,"signin",[e])}))}))}},{key:"invalidate",value:function(){var e=this,t=o();return Se(this,_e).ready.then((function(){return new Promise((function(n,r){e.once(t,(function(t){return Pe(e,Be,Je).call(e,t,n,r)})),Pe(e,Ce,Ne).call(e,t,"invalidate")}))}))}},{key:"authenticate",value:function(e){var t=this,n=o();return Se(this,_e).ready.then((function(){return new Promise((function(r,o){t.once(n,(function(e){return Pe(t,Be,Je).call(t,e,r,o)})),Pe(t,Ce,Ne).call(t,n,"authenticate",[e])}))}))}},{key:"live",value:function(e){var t=this,n=o();return this.wait().then((function(){return new Promise((function(r,o){t.once(n,(function(e){return Pe(t,De,He).call(t,e,r,o)})),Pe(t,Ce,Ne).call(t,n,"live",[e])}))}))}},{key:"kill",value:function(e){var t=this,n=o();return this.wait().then((function(){return new Promise((function(r,o){t.once(n,(function(e){return Pe(t,De,He).call(t,e,r,o)})),Pe(t,Ce,Ne).call(t,n,"kill",[e])}))}))}},{key:"let",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(e){return Pe(n,De,He).call(n,e,o,i)})),Pe(n,Ce,Ne).call(n,r,"let",[e,t])}))}))}},{key:"query",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(e){return Pe(n,De,He).call(n,e,o,i)})),Pe(n,Ce,Ne).call(n,r,"query",[e,t])}))}))}},{key:"select",value:function(e){var t=this,n=o();return this.wait().then((function(){return new Promise((function(r,o){t.once(n,(function(n){return Pe(t,Fe,Ke).call(t,n,"select",e,r,o)})),Pe(t,Ce,Ne).call(t,n,"select",[e])}))}))}},{key:"create",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(t){return Pe(n,Fe,Ke).call(n,t,"create",e,o,i)})),Pe(n,Ce,Ne).call(n,r,"create",[e,t])}))}))}},{key:"update",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(t){return Pe(n,Fe,Ke).call(n,t,"update",e,o,i)})),Pe(n,Ce,Ne).call(n,r,"update",[e,t])}))}))}},{key:"change",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(t){return Pe(n,Fe,Ke).call(n,t,"change",e,o,i)})),Pe(n,Ce,Ne).call(n,r,"change",[e,t])}))}))}},{key:"modify",value:function(e,t){var n=this,r=o();return this.wait().then((function(){return new Promise((function(o,i){n.once(r,(function(t){return Pe(n,Fe,Ke).call(n,t,"modify",e,o,i)})),Pe(n,Ce,Ne).call(n,r,"modify",[e,t])}))}))}},{key:"delete",value:function(e){var t=this,n=o();return this.wait().then((function(){return new Promise((function(r,o){t.once(n,(function(n){return Pe(t,Fe,Ke).call(t,n,"delete",e,r,o)})),Pe(t,Ce,Ne).call(t,n,"delete",[e])}))}))}}])&&de(t.prototype,n),r&&de(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(E);function Ie(){var e=this;je(this,Ae,new Promise((function(t,n){Se(e,xe)?e.authenticate(Se(e,xe)).then(t).catch(t):t()})))}function Ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Se(this,_e).send(JSON.stringify({id:e,method:t,params:n}))}function Je(e,t,n){return e.error?n(new Ue.AuthenticationError(e.error.message)):t(e.result)}function Ve(e,t,n){return e.error?n(new Ue.AuthenticationError(e.error.message)):(je(this,xe,e.result),t(e.result))}function Ge(e,t,n){return e.error?n(new Ue.AuthenticationError(e.error.message)):e.result?(je(this,xe,e.result),t(e.result)):void 0}function He(e,t,n){return e.error?n(new Error(e.error.message)):e.result?t(e.result):t()}function Ke(e,t,n,r,o){if(e.error)return o(new Error(e.error.message));if(e.result)switch(t){case"delete":return r();case"create":return e.result&&e.result.length?r(e.result[0]):o(new Ue.PermissionError("Unable to create record: ".concat(n)));case"update":case"change":case"modify":return"string"==typeof n&&n.includes(":")?e.result&&e.result.length?r(e.result[0]):o(new Ue.PermissionError("Unable to update record: ".concat(n))):r(e.result);default:return"string"==typeof n&&n.includes(":")?e.result&&e.result.length?r(e.result):o(new Ue.RecordError("Record not found: ".concat(n))):r(e.result)}return r()}})(),r.default})()));